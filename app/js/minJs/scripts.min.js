function showPage(){document.getElementById("loader").style.display="none",document.getElementById("headTitle").style.display="block",document.getElementById("app").style.display="block"}function draw(e){deleteLiElements(),createLiElements(e),SvgMap(),deleteSvgIcons(),createSvgIcons(e)}function test(){window.addEventListener("load",function(e){loadAccidents(),setTimeout(function(){showPage()},500)})}function removeHideClass(e){for(var t=3;t<e.childNodes.length;t+=2)e.childNodes[t].classList.remove("secondary-text__hidden")}function removeSelectedClass(e){e.classList.remove("mdc-list-item_selected")}function changeIconToClear(e){e.innerHTML="clear"}function showDetails(e){var t=e.childNodes[2],n=e.childNodes[4];addSelectedClass(e),removeHideClass(t),changeIconToClear(n)}function addHideClass(e){for(var t=3;t<e.childNodes.length;t+=2)e.childNodes[t].classList.add("secondary-text__hidden")}function addSelectedClass(e){e.classList.add("mdc-list-item_selected")}function changeIconToArrow(e){e.innerHTML="arrow_drop_down"}function hideDetails(e){var t=e.childNodes[2],n=e.childNodes[4];removeSelectedClass(e),addHideClass(t),changeIconToArrow(n)}function loadAccidents(){var e=new XMLHttpRequest;e.open("GET","js/incidents.json",!0),e.send(),e.onreadystatechange=function(){if(4===e.readyState)if(200!==e.status)alert(e.status+": "+e.statusText);else try{draw(JSON.parse(e.responseText))}catch(e){alert("Error "+e.message)}}}function typeAccidents(e){var t;switch(e.type){case 1:t="error";break;case 2:t="warning";break;case 3:t="location_off";break;default:t="clear"}return t}function createLiElements(n){var i,s=document.getElementById("accidentsList");sortingAccidentList(n),n.forEach(function(e,t){i=createLiElement(e,t,n.length-1),s.insertBefore(i,s.firstChild)})}function deleteLiElements(){for(var e=document.getElementById("accidentsList"),t=e.children.length,n=0;n<t;n++)e.removeChild(e.children[0])}function createLiElement(e,t,n){var i=typeAccidents(e);return liElement=document.createElement("li"),liElement.className="mdc-list-item",liElement.innerHTML='<span class="mdc-list-item__graphic material-icons md-36 orange600" aria-hidden="true">'+i+'</span>\n<span class="mdc-list-item__text">'+e.details+" on "+e.from+'\n<span class="mdc-list-item__secondary-text">'+e.id+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">Type : '+e.type+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">Position : x: '+e.point.x+", y: "+e.point.y+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">From: '+e.from+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">To: '+e.to+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">Details: '+e.details+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">Delay: '+e.delay+'</span>\n<span class="mdc-list-item__secondary-text secondary-text__hidden">Magnitude: '+e.magnitude+'</span>\n</span>\n<span class="mdc-list-item__meta material-icons md-36" aria-hidden="true">arrow_drop_down</span>',liElement.onclick=function(){changeColorSvgIcons(n-t)},liElement}function sortingAccidentList(e){for(var t=0;t<e.length;t++)for(var n=t;0!==n;)e[n-1].delay<e[n].delay&&swapLiElements(e,n-1,n),n--;return e}function swapLiElements(e,t,n){var i;i=e[n],e[n]=e[t],e[t]=i}function SvgMap(){var e=document.getElementById("svgMap"),t=document.getElementById("svgMapBackground"),n=(document.getElementById("img"),window.innerWidth/3094*.75),i=.75*window.innerWidth,s=1560*n;window.innerWidth<=1200&&(n=window.innerWidth/3094,i=window.innerWidth,s=1560*n),e.setAttribute("height",Math.round(s)),e.setAttribute("width",Math.round(i)),t.setAttribute("height",s),t.setAttribute("width",i)}function deleteSvgIcons(){for(var e=document.getElementById("svgMap"),t=e.children.length,n=0;n<t-2;n++)e.removeChild(e.children[1])}function createSvgIcons(i){var s=document.getElementById("svgMap");window.innerWidth;i.forEach(function(e,t){var n=createSvgIcon(i[t],t);s.insertBefore(n,s.lastChild)})}function createSvgIcon(e,t){var n=calculatedPositon(e),i=typeSvgIcon(typeAccidents(e)),s=window.innerWidth/3094*.75,d=36*s*2.5;window.innerWidth<=1200?d=36*(s=window.innerWidth/3094)*3:2e3<=window.innerWidth&&(d=36*s*2);var a,c=document.getElementById("rings");return c.setAttribute("width",2*d),c.setAttribute("height",2*d),(a=document.createElementNS("http://www.w3.org/2000/svg","svg")).className="svgIcon",a.id="svgIcon"+t,a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("width",d),a.setAttribute("height",d),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("x",n.x*s),a.setAttribute("y",n.y*s),a.innerHTML=i,a.addEventListener("click",function(){changeColorSvgIcons(t)}),a}function changeColorSvgIcons(e){for(var t=document.getElementById("svgMap"),n=t.children.length-2,i=document.getElementById("accidentsList"),s=i.children.length,d=0;d<s;d++)hideDetails(i.children[d]);for(d=2;d<n+2;d++)t.children[d].children[1].setAttribute("fill","#DF1A26");t.children[e+2].children[1].setAttribute("fill","#02A2A5");var a=document.getElementById("rings"),c=Math.round(t.children[e+2].getAttribute("height")),r=Math.round(t.children[e+2].getAttribute("width")),o=t.children[e+2].getAttribute("x")-r/2-.5,l=t.children[e+2].getAttribute("y")-c/2-.5;a.setAttribute("x",o),a.setAttribute("y",l),a.setAttribute("style","display: block;"),showDetails(i.children[e])}function typeSvgIcon(e){var t,n='<path d="M0 0h24v24H0z" fill="none"></path>',i='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="#DF1A26" stroke=\'rgba(0, 0, 0, 0.2)\'></path>';switch(e){case"warning":t=n+'<path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="#DF1A26" stroke=\'rgba(0, 0, 0, 0.3)\'></path>';break;case"error":t=n+i;break;case"location_off":t='<path d="M0 0h24v24H0zm11.75 11.47l-.11-.11z" fill="none"/></path>\n<path fill="#DF1A26" stroke=\'rgba(0, 0, 0, 0.25)\' d="M12 6.5c1.38 0 2.5 1.12 2.5 2.5 0 .74-.33 1.39-.83 1.85l3.63 3.63c.98-1.86 1.7-3.8 1.7-5.48 0-3.87-3.13-7-7-7-1.98 0-3.76.83-5.04 2.15l3.19 3.19c.46-.52 1.11-.84 1.85-.84zm4.37 9.6l-4.63-4.63-.11-.11L3.27 3 2 4.27l3.18 3.18C5.07 7.95 5 8.47 5 9c0 5.25 7 13 7 13s1.67-1.85 3.38-4.35L18.73 21 20 19.73l-3.63-3.63z"></path>';break;default:t=i}return t}function calculatedPositon(e){var t,n,i={x:0,y:0};return t=e.point.x-12.94303529912,n=52.64611109803-e.point.y,i.x=Math.round(t/.00034508963),i.y=Math.round(n/.00020789677),i}setInterval(function(){deleteLiElements(),loadAccidents()},12e4),test();